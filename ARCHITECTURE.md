# Архитектура

## Техническая архитектура

Система CodeCraft Academy представляет собой сеть взаимодействующих узлов, каждый из которых является отдельным сервером (реальным или виртуальным).

**Типы узлов:**

*   **Изначальный узел (Initial):**
    *   Центральный узел сети.
    *   Хранит реестр узлов и пользователей.
    *   Предоставляет общую библиотеку сущностей.
    *   Обеспечивает маршрутизацию сообщений между узлами (может проксировать запросы).
    *   Может выполнять функции узла-прокси.
    *   Поддерживает работу "общих пространств" для новичков.
*   **Доверенный узел (Trusted):**
    *   Полноценный узел сети.
    *   Может выступать в роли прокси-сервера для Локальных узлов.
    *   Может предоставлять вычислительные ресурсы другим пользователям (майнинг, аренда).
    *   Хранит данные и выполняет код аватаров-агентов, "живущих" на нем.
*   **Локальный узел (Local):**
    *   Работает на локальной машине пользователя (разработчика).
    *   Подключается к сети через узел-прокси (Изначальный или Доверенный).
    *   Предоставляет среду для разработки и тестирования аватаров-агентов в режиме "локальной песочницы".
    *   Может отправлять статистику на Доверенный узел.
*   **Узел-прокси:**
    *   Обеспечивает доступ к сети для Локальных узлов, не имеющих статического IP-адреса.
    *   Выполняет туннелирование трафика между Локальным узлом и сетью.

**Взаимодействие узлов:**

*   **Регистрация:**  При запуске узлы регистрируются на Изначальном узле, передавая свои данные (IP-адрес, порт, тип, имя, публичный ключ).
*   **Обмен сообщениями:**  Узлы могут обмениваться сообщениями друг с другом через Изначальный узел или напрямую (если настроено).
*   **Передача данных:**  Узлы могут передавать друг другу данные (например, при перемещении аватара-агента).
*   **Проксирование:**  Изначальный или Доверенный узел может выступать в роли прокси для Локальных узлов, не имеющих статического IP.
*   **Аутентификация:**  Взаимодействие между узлами должно быть защищено с помощью аутентификации (например, с использованием ключей SSH или токенов).

**Протоколы взаимодействия:**

*   **Регистрация узлов, получение списка узлов, общие запросы:**  REST API (Flask) через HTTPS.
*   **Взаимодействие между аватарами-агентами:**  [Заглушка:  Предположительно, WebSocket или REST API]
*   **Туннелирование трафика (прокси):**  SSH-туннелирование.
*   **Передача файлов (перемещение аватара):**  [Заглушка:  Предположительно, SCP, SFTP или REST API]

**Форматы данных:**

*   **JSON:**  Используется для передачи данных между узлами и аватарами-агентами.
*   **SQLite:**  Используется для хранения данных на узлах.

**Разделение вычислений:**

*   **Клиент (браузер):**
    *   Рендеринг интерфейса.
    *   Обработка пользовательского ввода.
    *   Взаимодействие с сервером через WebSocket (эмулятор терминала) или AJAX (REST API).
*   **Сервер (узел):**
    *   **Общий сервер (Изначальный, Доверенный):**
        *   Управление состоянием сети (реестр узлов, пользователей).
        *   Маршрутизация сообщений.
        *   Хранение общих данных (библиотека сущностей, глобальные данные мира).
        *   Поддержка работы "общих пространств".
        *   Обработка запросов от клиентов и других узлов.
        *   Взаимодействие с блокчейном (опционально).
        *   Модерация.
    *   **Локальный сервер:**
        *   Выполнение кода аватаров-агентов.
        *   Взаимодействие с другими узлами.
        *   Хранение данных, специфичных для узла.
        *   Поддержка режима "локальной песочницы".

## Схема сети

[Заглушка:  Добавить схему сети с указанием узлов, связей и потоков данных]

## Структура узла
